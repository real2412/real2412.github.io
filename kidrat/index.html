<!doctype html> 
<html lang="en"> 
<head> 
	<meta charset="UTF-8" />
	<title>KidRat</title>
	<script type="text/javascript" src="js/phaser.min.js"></script>
	<script type="text/javascript" src="js/weapon.js"></script>
    <style type="text/css">
        body {
            margin: 0;
	    background:black;
        }
    </style>
</head>
<body>

<script type="text/javascript">


var game = new Phaser.Game(640, 360, Phaser.CANVAS, 'kidrat', {init:init,  preload: preload, create: create, update: update, render: render });

function init() {
    game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
    game.scale.pageAlignHorizontally = true;
    game.scale.pageAlignVertically = true;
    game.scale.setScreenSize(true);
    game.scale.refresh();
}
	
function preload() {

    game.load.spritesheet('buttonvertical', 'assets/buttons/buttons-big/button-vertical.png',64,64);
    game.load.spritesheet('buttonhorizontal', 'assets/buttons/buttons-big/button-horizontal.png',96,64);
    game.load.spritesheet('buttondiagonal', 'assets/buttons/buttons-big/button-diagonal.png',64,64);
    game.load.spritesheet('buttonfire', 'assets/buttons/buttons-big/button-round-a.png',96,96);
    game.load.spritesheet('buttonjump', 'assets/buttons/buttons-big/button-round-b.png',96,96);
	
    //game.load.image('sky0','assets/skies/space2.png');
	
    game.load.tilemap('map', 'assets/tilemaps/maps/features_test.json', null, Phaser.Tilemap.TILED_JSON);
	game.load.tilemap('map2', 'assets/tilemaps/maps/features_test2.json', null, Phaser.Tilemap.TILED_JSON);
	game.load.tilemap('map3', 'assets/tilemaps/maps/features_test3.json', null, Phaser.Tilemap.TILED_JSON);
	game.load.tilemap('map4', 'assets/tilemaps/maps/features_test4.json', null, Phaser.Tilemap.TILED_JSON);
	game.load.tilemap('map5', 'assets/tilemaps/maps/features_test5.json', null, Phaser.Tilemap.TILED_JSON);
	game.load.tilemap('map6', 'assets/tilemaps/maps/features_test6.json', null, Phaser.Tilemap.TILED_JSON);
	

    game.load.image('ground_1x1', 'assets/tilemaps/tiles/ground_1x1.png');
    game.load.image('walls_1x2', 'assets/tilemaps/tiles/walls_1x2.png');
    game.load.image('tiles2', 'assets/tilemaps/tiles/tiles2.png');
	game.load.image('gridtiles', 'assets/tilemaps/tiles/gridtiles.png');
	game.load.image('tile_nuevo', 'assets/tilemaps/tiles/tile_nuevo.png');

    
    //game.load.spritesheet('coin', 'assets/sprites/coin.png', 32, 32);
	
	//game.load.atlas('pacman', 'assets/sprites/sprites.png', 'assets/sprites/sprites.json');
	game.load.spritesheet('pacman', 'assets/sprites/sprites.png', 32, 30);
	game.load.spritesheet('maloso', 'assets/sprites/baddie_cat_1.png', 16, 16);
	game.load.spritesheet('malomalo', 'assets/sprites/stormlord-dragon96x64.png', 96, 64);
	game.load.spritesheet('malofinal', 'assets/games/invaders/invader32x32x4.png', 32, 32);	
	game.load.spritesheet('platform', 'assets/sprites/espina.png', 38, 32);
	//game.load.spritesheet('platform', 'assets/tilemaps/tiles/gridtiles.png',32,32);
	game.load.spritesheet('big', 'assets/sprites/big_masked.png', 32, 30);
	
	game.load.bitmapFont('desyrel', 'assets/fonts/bitmapFonts/desyrel.png', 'assets/fonts/bitmapFonts/desyrel.xml');
	game.load.spritesheet('bullet', 'assets/sprites/rgblaser.png', 4, 4);
	
}

var cursors;
var map;
var coins;

var layer;
var sprite;

//MENU
var menu=1;


var weapon;
var ataque;

//botones
var fireballs;
var fireRate = 300;
var nextFire = 0;
var nextJump = 0;
var player; 
var left=false;
var right=false;
var duck= false;
var fire=false;
var jump=false;
  
function create() {
	
	var strMap;
	
	if(menu==1){
		strMap = 'map';
	}
	else if(menu==2){
		strMap = 'map2';
	}
	else if(menu==3){
		strMap = 'map3'
	}
	else if(menu==4){
		strMap = 'map4'
	}
	else if(menu==5){
		strMap = 'map5'
	}
	else if(menu==6){
		strMap = 'map6'
	}
	
	map = game.add.tilemap(strMap);		
    map.addTilesetImage('ground_1x1');
    map.addTilesetImage('walls_1x2');
    map.addTilesetImage('tiles2');
	map.addTilesetImage('tile_nuevo');
	//if(menu==3){
	//	map.addTilesetImage('gridtiles');
	//}	
    map.setCollisionBetween(1, 40);	
	
	layer = map.createLayer('Tile Layer 1');		
	layer.resizeWorld();		
	game.physics.startSystem(Phaser.Physics.ARCADE);
	
	/*
	weapon = game.add.weapon(30, 'bullet');
    weapon.setBulletFrames(0, 80, true);
    weapon.bulletKillType = Phaser.Weapon.KILL_WORLD_BOUNDS;
	weapon.bulletSpeed = 400;
	weapon.fireRate = 50;
	*/

	var posx=80;
	var posy=504;
	
	var posTextox=1046;
	var posTextoy=320;
	var colorTexto="#FF8100";
	
	if(menu==1){
		malos1();
	}else if(menu==2){	
		posx=10;
		posy=504;
		posTextox=1665;
		posTextoy=120;
		colorTexto="#1521BE";
		
		malos2();
		
	}else if(menu==3){
		posx=380;
		posy=10;
		posTextox=80;
		posTextoy=800;
		malos3();
	}
	else if(menu==4){
		posx=35;
		posy=582;
		posTextox=1680;
		posTextoy=200;
		malos4();
	}
	else if(menu==5){
		posx=740;
		posy=58;
		posTextox=200;
		posTextoy=2400;
		malos5();
	}
	else if(menu==6){
		var posx=7.6;
		var posy=522;
		
		posTextox=400;
		posTextoy=150;
		
		malos6();
	}
	
    
	trump = game.add.sprite(posx, posy, 'pacman');
    trump.frame = 0;
	game.physics.arcade.enable(trump);		
	trump.scale.setTo(0.9, 0.9);	
	trump.body.setSize(30, 26, 0, 4);		
	trump.body.bounce.y = 0;
    trump.body.gravity.y = 600;
    trump.body.collideWorldBounds = true;
	trump.animations.add('right', [2, 3], 5, true);
    trump.animations.add('left', [0, 1], 5, true);	
	trump.animations.add('tranqui_izq', [0], 5, true);	
	trump.animations.add('tranqui_der', [2], 5, true);	
	
    //weapon.trackSprite(trump, 0, 0, true);
	
	game.camera.follow(trump);	
	
	
    text = game.add.text(posTextox, posTextoy, '', { font: "16px Arial", fill: colorTexto ,stroke: "#765B5B",strokeThickness:3});
	cursors = game.input.keyboard.createCursorKeys();	
	
	//ataque = game.input.keyboard.addKey(Phaser.KeyCode.SPACEBAR);
	//scoreText = game.add.text(16, 106, 'score: 0', { fontSize: '32px', fill: '#fff' });
	//  Standard button (also used as our pointer tracker)
    
	
	//botones
	/*
	button1 = game.add.button(550, 500, 'button_saltar', accionBoton, this, 2, 1, 0);
    button1.name = 'saltar';
    button1.anchor.setTo(0.5, 0.5);
	
	button2 = game.add.button(350, 550, 'button_derecha', accionBoton, this, 1, 1, 1);
    button2.name = 'derecha';
    button2.anchor.setTo(0.5, 0.5);
	
	button3 = game.add.button(150, 550, 'button_izquierda', accionBoton, this, 0, 0, 0);
    button3.name = 'izquierda';
    button3.anchor.setTo(0.5, 0.5);*/
	buttonjump = game.add.button(500, 250, 'buttonjump', null, this, 0, 1, 0, 1);  //game, x, y, key, callback, callbackContext, overFrame, outFrame, downFrame, upFrame
    buttonjump.fixedToCamera = true;  //our buttons should stay on the same place  
    //buttonjump.events.onInputOver.add(function(){jump=true;});
    buttonjump.events.onInputOut.add(function(){jump=false;});
    buttonjump.events.onInputDown.add(function(){jump=true;});
    buttonjump.events.onInputUp.add(function(){jump=false;});

    /*buttonfire = game.add.button(700, 500, 'buttonfire', null, this, 0, 1, 0, 1);
    buttonfire.fixedToCamera = true;
    buttonfire.events.onInputOver.add(function(){fire=true;});
    buttonfire.events.onInputOut.add(function(){fire=false;});
    buttonfire.events.onInputDown.add(function(){fire=true;});
    buttonfire.events.onInputUp.add(function(){fire=false;});*/

    buttonleft = game.add.button(0, 272, 'buttonhorizontal', null, this, 0, 1, 0, 1);
    buttonleft.fixedToCamera = true;
    buttonleft.events.onInputOver.add(function(){left=true;});
    buttonleft.events.onInputOut.add(function(){left=false;});
    buttonleft.events.onInputDown.add(function(){left=true;});
    buttonleft.events.onInputUp.add(function(){left=false;});

    /*buttonbottomleft = game.add.button(32, 536, 'buttondiagonal', null, this, 6, 4, 6, 4);
    buttonbottomleft.fixedToCamera = true;
    buttonbottomleft.events.onInputOver.add(function(){left=true;duck=true;});
    buttonbottomleft.events.onInputOut.add(function(){left=false;duck=false;});
    buttonbottomleft.events.onInputDown.add(function(){left=true;duck=true;});
    buttonbottomleft.events.onInputUp.add(function(){left=false;duck=false;});*/

    buttonright = game.add.button(160, 272, 'buttonhorizontal', null, this, 0, 1, 0, 1);
    buttonright.fixedToCamera = true;
    buttonright.events.onInputOver.add(function(){right=true;});
    buttonright.events.onInputOut.add(function(){right=false;});
    buttonright.events.onInputDown.add(function(){right=true;});
    buttonright.events.onInputUp.add(function(){right=false;});

    /*buttonbottomright = game.add.button(160, 536, 'buttondiagonal', null, this, 7, 5, 7, 5);
    buttonbottomright.fixedToCamera = true;
    buttonbottomright.events.onInputOver.add(function(){right=true;duck=true;});
    buttonbottomright.events.onInputOut.add(function(){right=false;duck=false;});
    buttonbottomright.events.onInputDown.add(function(){right=true;duck=true;});
    buttonbottomright.events.onInputUp.add(function(){right=false;duck=false;});*/

    /*buttondown = game.add.button(96, 236, 'buttonvertical', null, this, 0, 1, 0, 1);
    buttondown.fixedToCamera = true;
    buttondown.events.onInputOver.add(function(){duck=true;});
    buttondown.events.onInputOut.add(function(){duck=false;});
    buttondown.events.onInputDown.add(function(){duck=true;});
    buttondown.events.onInputUp.add(function(){duck=false;});*/
	
	
}
/*boton
function accionBoton (button) {
	
	if(button.name=="saltar"){
		trump.body.velocity.y = -350;
	}else if(button.name=="derecha"){
		button2.kill();
		trump.body.velocity.x = 350;
		button2 = game.add.button(350, 550, 'button_derecha', accionBoton, this, 1, 1, 1);
		button2.name = 'derecha';
		button2.anchor.setTo(0.5, 0.5);
		
	}	
	else if(button.name=="izquierda"){
		trump.body.velocity.x = -350;
	}	
    //background.loadTexture(button.name);
}*/

var pasa1=true;
var pasa2=true;
var pasa3=true;
var pasa4=true;
var pasa5=true;
var pasa6=true;
var pasa7=true;
var pasa8=true;
var pasa9=true;
var pasa10=true;
var pasa11=true;
var pasa12=true;
var pasa13=true;
var pasa14=true;
var pasa15=Math.random()>=0.5? true:false;	
var pasa16=Math.random()>=0.5? true:false;
var pasa17= Math.random()>=0.5? true:false;
var pasa18=true;
var pasa19=true;
var pasa20=true;
var pasa21=true;
var pasa22=true;
var pasa23=true;
var pasa24=true;
var pasa25=true;
var pasa26=true;
var pasa27=true;
var pasa28=false;	
var pasa29=false;
var pasa30=false;
var pasa31=true;
var pasa32=false;
var pasa33=false;
var pasa34=true;

var mover32=false;

var vidasMalo=3;

var miraderecha=true;

function update() {

    game.physics.arcade.collide(layer,trump);
	
	if(menu==1){
		game.physics.arcade.overlap(trump, malo2, muerte, null, this);
		game.physics.arcade.collide(malo2, layer);
		pasa2=caminar(malo2,pasa2);		
		
		game.physics.arcade.overlap(trump, malo1, muerte, null, this);
		game.physics.arcade.collide(malo1, layer);
		pasa1=caminarporcoord(malo1, 2152, 2514,pasa1);
		
		game.physics.arcade.collide(bueno1, layer);
		game.physics.arcade.overlap(trump, bueno1, habla, null, this);
		
	}	
	else if(menu==2){
		game.physics.arcade.overlap(trump, malo3, muerte, null, this);
		game.physics.arcade.collide(malo3, layer);
		pasa3=caminar(malo3,pasa3);
		
		game.physics.arcade.overlap(trump, malo4, muerte, null, this);
		game.physics.arcade.collide(malo4, layer);
		pasa4=caminarporcoord(malo4, 1181,1319, pasa4);
		
		game.physics.arcade.overlap(trump, malo5, muerte, null, this);
		game.physics.arcade.collide(malo5, layer);
		pasa5=caminarporcoord(malo5, 1469, 1669, pasa5);
		
		//game.physics.arcade.collide(bueno2, layer);
		if(trump.x>=1665 && trump.y){
			habla(trump,null);
		}
		
	}
	else if(menu==3){
		game.physics.arcade.overlap(trump, malo6, muerte, null, this);
		game.physics.arcade.collide(malo6, layer);
		pasa6=caminarporcoord(malo6, 190, 298, pasa6);
		
		game.physics.arcade.overlap(trump, malo7, muerte, null, this);
		game.physics.arcade.collide(malo7, layer);
		pasa7=caminarporcoord(malo7, 440, 548, pasa7);
		
		game.physics.arcade.overlap(trump, malo8, muerte, null, this);
		game.physics.arcade.collide(malo8, layer);
		pasa8=caminarporcoord(malo8, 345, 425, pasa8);
		
		game.physics.arcade.collide(malo9, layer);		
		if(trump.y>=1800){
			game.physics.arcade.overlap(trump, malo9, muerte, null, this);
			game.physics.arcade.collide(trump, malo9);					
			var arr=[[170, 2000],[410, 2064],[577, 2192], [308, 2192]];
			pasa9=caminarportodoslados(malo9,pasa9, arr);
		}
		
		game.physics.arcade.collide(bueno3, layer);
		game.physics.arcade.overlap(trump, bueno3, habla, null, this);
		
		
	}
	else if(menu==4){
		game.physics.arcade.collide(malo10, layer);
		game.physics.arcade.overlap(trump, malo10, muerte, null, this);		
		pasa10=caminarportodoslados(malo10,pasa10, []);
		
		game.physics.arcade.collide(malo11, layer);
		game.physics.arcade.overlap(trump, malo11, muerte, null, this);		
		pasa11=caminarportodoslados(malo11,pasa11, []);
		
		game.physics.arcade.collide(malo12, layer);
		game.physics.arcade.overlap(trump, malo12, muerte, null, this);		
		pasa12=caminarportodoslados(malo12,pasa12, []);
		
		game.physics.arcade.collide(malo13, layer);
		game.physics.arcade.overlap(trump, malo13, muerte, null, this);		
		pasa13=caminarportodoslados(malo13,pasa13, []);
		
		game.physics.arcade.collide(malo14, layer);
		game.physics.arcade.overlap(trump, malo14, muerte, null, this);		
		pasa14=caminarportodoslados(malo14,pasa14, []);
		
		game.physics.arcade.collide(malo15, layer);
		game.physics.arcade.overlap(trump, malo15, muerte, null, this);		
		pasa15=caminarportodoslados(malo15,pasa15, []);
		
		game.physics.arcade.collide(malo16, layer);
		game.physics.arcade.overlap(trump, malo16, muerte, null, this);		
		pasa16=caminarportodoslados(malo16,pasa16, []);
		
		game.physics.arcade.collide(malo17, layer);
		game.physics.arcade.overlap(trump, malo17, muerte, null, this);		
		pasa17=caminarportodoslados(malo17,pasa17, []);
		
		game.physics.arcade.overlap(trump, malo18, muerte, null, this);
		game.physics.arcade.collide(malo18, layer);
		pasa18=caminarporcoord(malo18, 611, 777, pasa18);
		
		game.physics.arcade.overlap(trump, malo19, muerte, null, this);
		game.physics.arcade.collide(malo19, layer);
		pasa19=caminarporcoord(malo19, 1123, 1256, pasa19);
		
		game.physics.arcade.overlap(trump, malo20, muerte, null, this);
		game.physics.arcade.collide(malo20, layer);
		pasa20=caminarporcoord(malo20, 1480, 1670, pasa20);
		
		game.physics.arcade.overlap(trump, malo21, muerte, null, this);
		game.physics.arcade.collide(malo21, layer);
		pasa21=caminarporcoord(malo21, 1765, 2056, pasa21);
		
		game.physics.arcade.overlap(trump, bueno4, habla, null, this);
		game.physics.arcade.collide(bueno4, layer);
		
	}
	else if(menu==5){
		
		game.physics.arcade.collide(malo22, layer);
		if(trump.y>=348){			
			game.physics.arcade.overlap(trump, malo22, muerte, null, this);		
			pasa22=caminarportodoslados(malo22,pasa22, []);
		}
		
		game.physics.arcade.collide(malo23, layer);
		if(trump.y>=464){						
			game.physics.arcade.overlap(trump, malo23, muerte, null, this);		
			pasa23=caminarportodoslados(malo23,pasa23, []);
		}
		
		game.physics.arcade.collide(malo24, layer);
		if(trump.y>=560){						
			game.physics.arcade.overlap(trump, malo24, muerte, null, this);		
			pasa24=caminarportodoslados(malo24,pasa24, []);
		}
		game.physics.arcade.collide(malo25, layer);
		game.physics.arcade.overlap(trump, malo25, muerte, null, this);		
		pasa25=caminarportodoslados(malo25,pasa25, []);
		
		game.physics.arcade.collide(malo26, layer);
		game.physics.arcade.overlap(trump, malo26, muerte, null, this);		
		pasa26=caminarportodoslados(malo26,pasa26, []);
		
		game.physics.arcade.collide(malo27, layer);
		game.physics.arcade.overlap(trump, malo27, muerte, null, this);		
		pasa27=caminarportodoslados(malo27,pasa27, []);
		
		game.physics.arcade.collide(malo28, layer);
		game.physics.arcade.overlap(trump, malo28, muerte, null, this);		
		pasa28=caminarportodoslados(malo28,pasa28, []);
		
		game.physics.arcade.collide(malo29, layer);
		game.physics.arcade.overlap(trump, malo29, muerte, null, this);		
		pasa29=caminarportodoslados(malo29,pasa29, []);
		
		game.physics.arcade.collide(malo30, layer);
		game.physics.arcade.overlap(trump, malo30, muerte, null, this);		
		pasa30=caminarportodoslados(malo30,pasa30, []);
		
		game.physics.arcade.collide(malo31, layer);
		game.physics.arcade.overlap(trump, malo31, muerte, null, this);		
		pasa31=caminarportodoslados(malo31,pasa31, []);
		
		game.physics.arcade.collide(malo32, layer);
		if(trump.x>=446 && trump.y>=1712){mover32=true;}
		
		if(mover32){
			game.physics.arcade.overlap(trump, malo32, muerte, null, this);		
			pasa32=caminarportodoslados(malo32,pasa32, [[360,2064],[292,2000],[191,2192]]);
			
		}
		
		
		
	}
	else if(menu==6){
		//game.physics.arcade.collide(malo10, layer);
		//game.physics.arcade.overlap(trump, malo33, null, this);		
		//game.physics.arcade.collide(trump, malo33);
		
		game.physics.arcade.overlap(trump, malo33, habla, null, this);
		game.physics.arcade.collide(malo33, layer);
		
		if(typeof malo34 !== "undefined"){
			game.physics.arcade.collide(malo34, layer);
			game.physics.arcade.overlap(trump, malo34, muerte, null, this);		
			
			game.physics.arcade.overlap(malo34, malo35, function(){
				vidasMalo=vidasMalo-1;
				if(vidasMalo==0){
					//malo34.kill();
				}
			}, null, this);
			
			game.physics.arcade.collide(malo34, malo35);
			pasa34=caminarportodoslados(malo34,pasa34, []);
			
			if(malo34.x-trump.x<=100 && malo34.x-trump.x>=-100 && malo34.y-trump.y>=50){
				malo34.body.velocity.y = -300;
			}
		}
		
		//game.physics.arcade.overlap(trump, malo33, muerte, null, this);		
		//pasa33=caminarportodoslados(malo33,pasa33, []);
		
		//game.physics.arcade.collide(trump, malo34);
		game.physics.arcade.collide(trump, malo35);
		//game.physics.arcade.collide(trump, malo36);
		
		//game.physics.arcade.overlap(trump, malo33, caida, null, this);		
		
		
	}
		
    trump.body.velocity.x = 0;
	
	
	//movimientos
    if (cursors.left.isDown)
    {
        trump.body.velocity.x = -150;
		trump.animations.play('left');		
		miraderecha=false;
    }
    else if (cursors.right.isDown)
    {
        trump.animations.play('right');		
		trump.body.velocity.x = 150;
		miraderecha=true;
		
    }else{
		if(miraderecha){
			trump.animations.play('tranqui_der');	
		}else{
			trump.animations.play('tranqui_izq');	
		}
		
	    
	}

    if (cursors.up.isDown && (trump.body.onFloor() || trump.body.touching.down))
    {				
        trump.body.velocity.y = -350;
    }
	
	//scoreText.text =sprite.y;
	if(menu==2 && trump.x>=700 && trump.x<=800 && trump.y>=599){
		menu++;
		limpieza();				
	}
	
	if(menu==3 && trump.x>=770){		
		menu++;
		limpieza();		
	}
	
	
	/*if(trump.y>=600 && menu<=2){
		caer(trump);
	}*/
	
	if(trump.body.speed>=700 && menu<4){
		limpieza();		
	}
	if(trump.y>=600 && menu==4){		
		menu++;
		limpieza();						
	}
	
	if(trump.x>=760 && menu==5){		
		menu++;
		limpieza();		
	}
	
	if(menu==1 && trump.x>=game.world.width-50 ){				
		menu++;
		limpieza();			
	}
	
	//botones
	if (left && !duck) {
        //trump.scale.x = -1;
        //trump.body.moveLeft(500);
        //trump.animations.play('walk');
		trump.body.velocity.x = -150;
		trump.animations.play('left');
    }
		else if (right && !duck) {
        //trump.scale.x = 1;
        //trump.body.moveRight(500);
        //trump.animations.play('walk');
		trump.animations.play('right');		
		trump.body.velocity.x = 150;
    } 
	
    if (jump && (trump.body.onFloor() || trump.body.touching.down)){ 		
			//jump_now(); 
			trump.body.velocity.y = -350;
		
		
	}  
    
	if (duck){ 
	//trump.body.setCircle(16,0,6);
	}
	else{ //trump.body.setCircle(22);
	}  //when ducking create a smaller hitarea - (radius,offsetx,offsety)
    if (game.input.currentPointers == 0 && !game.input.activePointer.isMouse){ fire=false; right=false; left=false; duck=false; jump=false;} //this works around a "bug" where a button gets stuck in pressed state
	

}

function limpieza(){
	trump.kill();
	layer.destroy();
	text.text="";
	create();		
}

function caminarporcoord(mal,x1,x2, pas){
	
	if(mal.x>x1 && pas){
		mal.body.velocity.x = -100;		
		mal.animations.play('left');	
		//pasa1=false;
	}else if(mal.x<x2){
		mal.body.velocity.x = 100;
		mal.animations.play('right');	
		pas=false;
	}
	else{
		pas=true;
	}
	
	return pas;
}

function caminarportodoslados(mal,pas, arruga){	
	
	if(mal.body.onWall()){
		if(pas){
			pas=false;
		}
		else{
			pas=true;
		}
	}
	
	for(var i=0; i<arruga.length; i++){
		if(mal.x>=arruga[i][0]-5 && mal.x<=arruga[i][0]+10 && mal.y>=arruga[i][1]-20 && mal.y<=arruga[i][1]+20){
			mal.body.velocity.y = -600;
			//break;
		}
	}
	
	if(!pas){
			mal.body.velocity.x = -200;			
			mal.animations.play('left');	
	}else{
		mal.body.velocity.x = 200;
		mal.animations.play('right');	
	}
	
	
	return pas;
}

function caminar(mal,pas){
	
	if(mal.body.onWall() || !mal.body.onFloor()){		
		if(pas){
			pas=false;
		}
		else{
			pas=true;
		}		
	}
	
	if(!pas){
		mal.body.velocity.x = -100;
		mal.animations.play('left');	
		//pasa=false;
	}else{
		mal.body.velocity.x = 100;
		mal.animations.play('right');	
		//pasa=false;
	}
	
	return pas;
}

function malos1() {
	
	malo1=game.add.sprite(2200, 520, 'maloso');
	malo1.enableBody = true;	
	game.physics.arcade.enable(malo1);	
	malo1.body.setSize(16, 16, 0, 0);
	malo1.scale.setTo(2, 2);
	malo1.body.bounce.y = 0;
    malo1.body.gravity.y = 600;
	malo1.body.collideWorldBounds = true;
	malo1.animations.add('left', [0,1], 10, true);
	malo1.animations.add('right', [2,3], 10, true);
	
	
	malo2=game.add.sprite(991, 400, 'maloso');
	malo2.enableBody = true;
	game.physics.arcade.enable(malo2);	
	malo2.body.setSize(16, 16, 0, 0);
	malo2.scale.setTo(2, 2);
	malo2.body.bounce.y = 0;
    malo2.body.gravity.y = 600;
	malo2.body.collideWorldBounds = true;
	malo2.animations.add('left', [0,1], 10, true);
	malo2.animations.add('right', [2,3], 10, true);
	
	bueno1 = game.add.sprite(1206, 518, 'pacman');
    game.physics.arcade.enable(bueno1);
	bueno1.body.setSize(32, 32, 0, 0);		
	bueno1.body.bounce.y = 0;
    bueno1.body.gravity.y = 600;
    bueno1.body.collideWorldBounds = true;
	bueno1.animations.add('habla', [01,02], 5, true);
	
	//coins = game.add.group();
    //coins.enableBody = true;
	
    //  And now we convert all of the Tiled objects with an ID of 34 into sprites within the coins group
    //map.createFromObjects('Object Layer 1', 34, 'coin', 0, true, false, coins);

    //  Add animations to all of the coin sprites
    //coins.callAll('animations.add', 'animations', 'spin', [0, 1, 2, 3, 4, 5], 10, true);
    //coins.callAll('animations.play', 'animations', 'spin');	
}

function malos2() {
	if(typeof malo1 !== "undefined"){
		malo1.kill();
	}
	if(typeof malo2 !== "undefined"){
		malo2.kill();	
	}
	if(typeof bueno1 !== "undefined"){
		bueno1.kill();
	}
	
	
	
	malo3=game.add.sprite(480, 500, 'maloso');
	malo3.enableBody = true;	
	game.physics.arcade.enable(malo3);	
	malo3.body.setSize(16, 16, 0, 0);
	malo3.scale.setTo(2, 2);
	malo3.body.bounce.y = 0;
    malo3.body.gravity.y = 600;
	malo3.body.collideWorldBounds = true;
	malo3.animations.add('left', [0,1], 10, true);
	malo3.animations.add('right', [2,3], 10, true);
	
	
	malo4=game.add.sprite(1200, 380, 'maloso');
	malo4.enableBody = true;
	game.physics.arcade.enable(malo4);	
	malo4.body.setSize(16, 16, 0, 0);
	malo4.scale.setTo(2, 2);	
	malo4.body.bounce.y = 0;
    malo4.body.gravity.y = 600;
	malo4.body.collideWorldBounds = true;
	malo4.animations.add('left', [0,1], 10, true);
	malo4.animations.add('right', [2,3], 10, true);
	
	
	malo5=game.add.sprite(1500, 450, 'maloso');
	malo5.enableBody = true;
	game.physics.arcade.enable(malo5);	
	malo5.body.setSize(16, 16, 0, 0);
	malo5.scale.setTo(2, 2);
	malo5.body.bounce.y = 0;
    malo5.body.gravity.y = 600;
	malo5.body.collideWorldBounds = true;
	malo5.animations.add('left', [0,1], 10, true);
	malo5.animations.add('right', [2,3], 10, true);	
	
}

function malos3() {
	if(typeof malo3 !== "undefined"){
		malo3.kill();
	}
	if(typeof malo4 !== "undefined"){
		malo4.kill();	
	}
	if(typeof malo5 !== "undefined"){
		malo5.kill();
	}
	
	malo6=game.add.sprite(200, 348, 'maloso');
	malo6.enableBody = true;	
	game.physics.arcade.enable(malo6);	
	malo6.body.setSize(16, 16, 0, 0);
	malo6.scale.setTo(2, 2);
	malo6.body.bounce.y = 0;
    malo6.body.gravity.y = 600;
	malo6.body.collideWorldBounds = true;
	malo6.animations.add('left', [0,1], 10, true);
	malo6.animations.add('right', [2,3], 10, true);
	
	
	malo7=game.add.sprite(500, 348, 'maloso');
	malo7.enableBody = true;	
	game.physics.arcade.enable(malo7);	
	malo7.body.setSize(16, 16, 0, 0);
	malo7.scale.setTo(2, 2);
	malo7.body.bounce.y = 0;
    malo7.body.gravity.y = 600;
	malo7.body.collideWorldBounds = true;
	malo7.animations.add('left', [0,1], 10, true);
	malo7.animations.add('right', [2,3], 10, true);
	
	
	malo8=game.add.sprite(400, 828, 'maloso');
	malo8.enableBody = true;	
	game.physics.arcade.enable(malo8);	
	malo8.body.setSize(16, 16, 0, 0);
	malo8.scale.setTo(2, 2);
	malo8.body.bounce.y = 0;
    malo8.body.gravity.y = 600;
	malo8.body.collideWorldBounds = true;
	malo8.animations.add('left', [0,1], 10, true);
	malo8.animations.add('right', [2,3], 10, true);
	
	
	malo9=game.add.sprite(20, 1000, 'malomalo');
	malo9.enableBody = true;	
	game.physics.arcade.enable(malo9);	
	malo9.body.setSize(96, 35, 0, 15);
	malo9.scale.setTo(0.5, 0.5);
	malo9.body.bounce.y = 0;
    malo9.body.gravity.y = 600;
	malo9.body.collideWorldBounds = true;
	malo9.animations.add('left',  [7,8,9,10,11], 10, true);
	malo9.animations.add('right', [2,3,4,5], 10, true);
	
	bueno3 = game.add.sprite(73, 956, 'pacman');
    game.physics.arcade.enable(bueno3);	
	bueno3.body.setSize(32, 32, 0, 0);		
	bueno3.body.bounce.y = 0;
    bueno3.body.gravity.y = 600;
    bueno3.body.collideWorldBounds = true;
	bueno3.animations.add('habla', [01,02], 5, true);
	
	
}

function malos4() {
	if(typeof malo6 !== "undefined"){
		malo6.kill();
	}
	if(typeof malo7 !== "undefined"){
		malo7.kill();
	}
	if(typeof malo8 !== "undefined"){
		malo8.kill();
	}
	if(typeof malo9 !== "undefined"){
		malo9.kill();
	}
	
	malo10=game.add.sprite(400, 348, 'malomalo');
	malo10.enableBody = true;	
	game.physics.arcade.enable(malo10);	
	malo10.body.setSize(96, 35, 0, 15);
	malo10.scale.setTo(0.5, 0.5);
	malo10.body.bounce.y = 0;
    malo10.body.gravity.y = 600;
	malo10.body.collideWorldBounds = true;
	malo10.animations.add('left',  [7,8,9,10,11], 10, true);
	malo10.animations.add('right', [2,3,4,5], 10, true);
	
	malo11=game.add.sprite(327, 168, 'malomalo');
	malo11.enableBody = true;	
	game.physics.arcade.enable(malo11);	
	malo11.body.setSize(96, 35, 0, 15);
	malo11.scale.setTo(0.5, 0.5);
	malo11.body.bounce.y = 0;
    malo11.body.gravity.y = 600;
	malo11.body.collideWorldBounds = true;
	malo11.animations.add('left',  [7,8,9,10,11], 10, true);
	malo11.animations.add('right', [2,3,4,5], 10, true);
	
	malo12=game.add.sprite(656, 572, 'malomalo');
	malo12.enableBody = true;	
	game.physics.arcade.enable(malo12);	
	malo12.body.setSize(96, 35, 0, 15);
	malo12.scale.setTo(0.5, 0.5);
	malo12.body.bounce.y = 0;
    malo12.body.gravity.y = 600;
	malo12.body.collideWorldBounds = true;
	malo12.animations.add('left',  [7,8,9,10,11], 10, true);
	malo12.animations.add('right', [2,3,4,5], 10, true);
	
	malo13=game.add.sprite(912, 572, 'malomalo');
	malo13.enableBody = true;	
	game.physics.arcade.enable(malo13);	
	malo13.body.setSize(96, 35, 0, 15);
	malo13.scale.setTo(0.5, 0.5);
	malo13.body.bounce.y = 0;
    malo13.body.gravity.y = 600;
	malo13.body.collideWorldBounds = true;
	malo13.animations.add('left',  [7,8,9,10,11], 10, true);
	malo13.animations.add('right', [2,3,4,5], 10, true);
	
	malo14=game.add.sprite(1038, 572, 'malomalo');
	malo14.enableBody = true;	
	game.physics.arcade.enable(malo14);	
	malo14.body.setSize(96, 35, 0, 15);
	malo14.scale.setTo(0.5, 0.5);
	malo14.body.bounce.y = 0;
    malo14.body.gravity.y = 600;
	malo14.body.collideWorldBounds = true;
	malo14.animations.add('left',  [7,8,9,10,11], 10, true);
	malo14.animations.add('right', [2,3,4,5], 10, true);
	
	malo15=game.add.sprite(1233, 572, 'malomalo');
	malo15.enableBody = true;	
	game.physics.arcade.enable(malo15);	
	malo15.body.setSize(96, 35, 0, 15);
	malo15.scale.setTo(0.5, 0.5);
	malo15.body.bounce.y = 0;
    malo15.body.gravity.y = 600;
	malo15.body.collideWorldBounds = true;
	malo15.animations.add('left',  [7,8,9,10,11], 10, true);
	malo15.animations.add('right', [2,3,4,5], 10, true);
	
	malo16=game.add.sprite(1529, 572, 'malomalo');
	malo16.enableBody = true;	
	game.physics.arcade.enable(malo16);	
	malo16.body.setSize(96, 35, 0, 15);
	malo16.scale.setTo(0.5, 0.5);
	malo16.body.bounce.y = 0;
    malo16.body.gravity.y = 600;
	malo16.body.collideWorldBounds = true;
	malo16.animations.add('left',  [7,8,9,10,11], 10, true);
	malo16.animations.add('right', [2,3,4,5], 10, true);
	
	malo17=game.add.sprite(1782, 572, 'malomalo');
	malo17.enableBody = true;	
	game.physics.arcade.enable(malo17);	
	malo17.body.setSize(96, 35, 0, 15);
	malo17.scale.setTo(0.5, 0.5);
	malo17.body.bounce.y = 0;
    malo17.body.gravity.y = 600;
	malo17.body.collideWorldBounds = true;
	malo17.animations.add('left',  [7,8,9,10,11], 10, true);
	malo17.animations.add('right', [2,3,4,5], 10, true);
	
	malo18=game.add.sprite(700, 124, 'maloso');
	malo18.enableBody = true;	
	game.physics.arcade.enable(malo18);	
	malo18.body.setSize(16, 16, 0, 0);
	malo18.scale.setTo(2, 2);
	malo18.body.bounce.y = 0;
    malo18.body.gravity.y = 600;
	malo18.body.collideWorldBounds = true;
	malo18.animations.add('left', [0,1], 10, true);
	malo18.animations.add('right', [2,3], 10, true);
	
	malo19=game.add.sprite(1200, 124, 'maloso');
	malo19.enableBody = true;	
	game.physics.arcade.enable(malo19);	
	malo19.body.setSize(16, 16, 0, 0);
	malo19.scale.setTo(2, 2);
	malo19.body.bounce.y = 0;
    malo19.body.gravity.y = 600;
	malo19.body.collideWorldBounds = true;
	malo19.animations.add('left', [0,1], 10, true);
	malo19.animations.add('right', [2,3], 10, true);
	
	malo20=game.add.sprite(1500, 444, 'maloso');
	malo20.enableBody = true;	
	game.physics.arcade.enable(malo20);	
	malo20.body.setSize(16, 16, 0, 0);
	malo20.scale.setTo(2, 2);
	malo20.body.bounce.y = 0;
    malo20.body.gravity.y = 600;
	malo20.body.collideWorldBounds = true;
	malo20.animations.add('left', [0,1], 10, true);
	malo20.animations.add('right', [2,3], 10, true);
	
	malo21=game.add.sprite(1800, 444, 'maloso');
	malo21.enableBody = true;	
	game.physics.arcade.enable(malo21);	
	malo21.body.setSize(16, 16, 0, 0);
	malo21.scale.setTo(2, 2);
	malo21.body.bounce.y = 0;
    malo21.body.gravity.y = 600;
	malo21.body.collideWorldBounds = true;
	malo21.animations.add('left', [0,1], 10, true);
	malo21.animations.add('right', [2,3], 10, true);
	
	bueno4 = game.add.sprite(1925, 348, 'pacman');
    game.physics.arcade.enable(bueno4);
	bueno4.body.setSize(32, 32, 0, 0);		
	bueno4.body.bounce.y = 0;
    bueno4.body.gravity.y = 600;
    bueno4.body.collideWorldBounds = true;
	bueno4.animations.add('habla', [01,02], 5, true);
    
	
}

function malos5() {
	if(typeof malo9 !== "undefined"){
		malo10.kill();
	}
	if(typeof malo11 !== "undefined"){
		malo11.kill();
	}
	if(typeof malo12 !== "undefined"){
		malo12.kill();
	}
	if(typeof malo13 !== "undefined"){
		malo13.kill();
	}
	if(typeof malo14 !== "undefined"){
		malo14.kill();
	}
	if(typeof malo15 !== "undefined"){
		malo15.kill();
	}
	if(typeof malo16 !== "undefined"){
		malo16.kill();
	}
	if(typeof malo17 !== "undefined"){
		malo17.kill();
	}
	if(typeof malo18 !== "undefined"){
		malo18.kill();
	}
	if(typeof malo19 !== "undefined"){
		malo19.kill();
	}
	if(typeof malo20 !== "undefined"){
		malo20.kill();
	}
	if(typeof malo21 !== "undefined"){
		malo21.kill();
	}
	
	malo22=game.add.sprite(393, 252, 'malomalo');
	malo22.enableBody = true;	
	game.physics.arcade.enable(malo22);	
	malo22.body.setSize(96, 35, 0, 15);
	malo22.scale.setTo(0.5, 0.5);
	malo22.body.bounce.y = 0;
    malo22.body.gravity.y = 600;
	malo22.body.collideWorldBounds = true;
	malo22.animations.add('left',  [7,8,9,10,11], 10, true);
	malo22.animations.add('right', [2,3,4,5], 10, true);
	
	malo23=game.add.sprite(391, 400, 'malomalo');
	malo23.enableBody = true;	
	game.physics.arcade.enable(malo23);	
	malo23.body.setSize(96, 35, 0, 15);
	malo23.scale.setTo(0.5, 0.5);
	malo23.body.bounce.y = 0;
    malo23.body.gravity.y = 600;
	malo23.body.collideWorldBounds = true;
	malo23.animations.add('left',  [7,8,9,10,11], 10, true);
	malo23.animations.add('right', [2,3,4,5], 10, true);
	
	malo24=game.add.sprite(391, 508, 'malomalo');
	malo24.enableBody = true;	
	game.physics.arcade.enable(malo24);	
	malo24.body.setSize(96, 35, 0, 15);
	malo24.scale.setTo(0.5, 0.5);
	malo24.body.bounce.y = 0;
    malo24.body.gravity.y = 600;
	malo24.body.collideWorldBounds = true;
	malo24.animations.add('left',  [7,8,9,10,11], 10, true);
	malo24.animations.add('right', [2,3,4,5], 10, true);
	
	malo25=game.add.sprite(741, 892, 'malomalo');
	malo25.enableBody = true;	
	game.physics.arcade.enable(malo25);	
	malo25.body.setSize(96, 35, 0, 15);
	malo25.scale.setTo(0.5, 0.5);
	malo25.body.bounce.y = 0;
    malo25.body.gravity.y = 600;
	malo25.body.collideWorldBounds = true;
	malo25.animations.add('left',  [7,8,9,10,11], 10, true);
	malo25.animations.add('right', [2,3,4,5], 10, true);
	
	malo26=game.add.sprite(393, 988, 'malomalo');
	malo26.enableBody = true;	
	game.physics.arcade.enable(malo26);	
	malo26.body.setSize(96, 35, 0, 15);
	malo26.scale.setTo(0.5, 0.5);
	malo26.body.bounce.y = 0;
    malo26.body.gravity.y = 600;
	malo26.body.collideWorldBounds = true;
	malo26.animations.add('left',  [7,8,9,10,11], 10, true);
	malo26.animations.add('right', [2,3,4,5], 10, true);
	
	malo27=game.add.sprite(741, 1084, 'malomalo');
	malo27.enableBody = true;	
	game.physics.arcade.enable(malo27);	
	malo27.body.setSize(96, 35, 0, 15);
	malo27.scale.setTo(0.5, 0.5);
	malo27.body.bounce.y = 0;
    malo27.body.gravity.y = 600;
	malo27.body.collideWorldBounds = true;
	malo27.animations.add('left',  [7,8,9,10,11], 10, true);
	malo27.animations.add('right', [2,3,4,5], 10, true);
	
	malo28=game.add.sprite(393, 1180, 'malomalo');
	malo28.enableBody = true;	
	game.physics.arcade.enable(malo28);	
	malo28.body.setSize(96, 35, 0, 15);
	malo28.scale.setTo(0.5, 0.5);
	malo28.body.bounce.y = 0;
    malo28.body.gravity.y = 600;
	malo28.body.collideWorldBounds = true;
	malo28.animations.add('left',  [7,8,9,10,11], 10, true);
	malo28.animations.add('right', [2,3,4,5], 10, true);
	
	
	malo29=game.add.sprite(741, 1276, 'malomalo');
	malo29.enableBody = true;	
	game.physics.arcade.enable(malo29);	
	malo29.body.setSize(96, 35, 0, 15);
	malo29.scale.setTo(0.5, 0.5);
	malo29.body.bounce.y = 0;
    malo29.body.gravity.y = 600;
	malo29.body.collideWorldBounds = true;
	malo29.animations.add('left',  [7,8,9,10,11], 10, true);
	malo29.animations.add('right', [2,3,4,5], 10, true);
	
	malo30=game.add.sprite(393, 1372, 'malomalo');
	malo30.enableBody = true;	
	game.physics.arcade.enable(malo30);	
	malo30.body.setSize(96, 35, 0, 15);
	malo30.scale.setTo(0.5, 0.5);
	malo30.body.bounce.y = 0;
    malo30.body.gravity.y = 600;
	malo30.body.collideWorldBounds = true;
	malo30.animations.add('left',  [7,8,9,10,11], 10, true);
	malo30.animations.add('right', [2,3,4,5], 10, true);
	
	malo31=game.add.sprite(580, 1530, 'malomalo');
	malo31.enableBody = true;	
	game.physics.arcade.enable(malo31);	
	malo31.body.setSize(96, 35, 0, 15);
	malo31.scale.setTo(0.5, 0.5);
	malo31.body.bounce.y = 0;
    malo31.body.gravity.y = 600;
	malo31.body.collideWorldBounds = true;
	malo31.animations.add('left',  [7,8,9,10,11], 10, true);
	malo31.animations.add('right', [2,3,4,5], 10, true);
	
	malo32=game.add.sprite(658, 1700, 'malofinal');
	malo32.enableBody = true;	
	game.physics.arcade.enable(malo32);	
	malo32.body.setSize(32, 32, 0, 0);
    //malo32.scale.setTo(1, 1);
	malo32.body.bounce.y = 0;
    malo32.body.gravity.y = 600;
	malo32.body.collideWorldBounds = true;
	malo32.animations.add('left',  [5,6],5, true);
	malo32.animations.add('right', [7,8],5, true);
	
	
	bueno5 = game.add.sprite(400, 2502, 'pacman');
    game.physics.arcade.enable(bueno5);
	bueno5.body.setSize(32, 32, 0, 0);		
	bueno5.body.bounce.y = 0;
    bueno5.body.gravity.y = 600;
    bueno5.body.collideWorldBounds = true;
	bueno5.animations.add('habla', [01,02], 5, true);
	
}

function malos6() {
	/*
	malo22.kill();
	malo23.kill();
	malo24.kill();
	malo25.kill();
	malo26.kill();
	malo27.kill();
	malo28.kill();
	malo29.kill();
	malo30.kill();
	malo31.kill();
	malo32.kill();
	*/
	if(typeof malo22 !== "undefined"){
		malo22.kill();
	}
	if(typeof malo23 !== "undefined"){
		malo23.kill();
	}
	if(typeof malo24 !== "undefined"){
		malo24.kill();
	}
	if(typeof malo25 !== "undefined"){
		malo25.kill();
	}
	if(typeof malo26 !== "undefined"){
		malo26.kill();
	}
	if(typeof malo27 !== "undefined"){
		malo27.kill();
	}
	if(typeof malo28 !== "undefined"){
		malo28.kill();
	}
	if(typeof malo29 !== "undefined"){
		malo29.kill();
	}
	if(typeof malo30 !== "undefined"){
		malo30.kill();
	}
	if(typeof malo31 !== "undefined"){
		malo31.kill();
	}
	if(typeof malo32 !== "undefined"){
		malo32.kill();
	}
	
	//malofinalcorriendo
	if(typeof malo34 !== "undefined"){
		malo34.kill();
	}
	
	
	malo33=game.add.sprite(300, 240, 'big');	
	malo33.enableBody = true;	
	game.physics.arcade.enable(malo33);	
	malo33.body.setSize(32, 32, 0, 0);
    malo33.scale.setTo(1.5, 1.5);
	malo33.body.bounce.y = 0;
    malo33.body.gravity.y = 600;
	malo33.body.collideWorldBounds = true;		
	//malo33.animations.add('right', [2,1],6, true);
	//malo33.animations.add('left',  [3,4],6, true);
	malo33.animations.add('tranqui', [0],6, true);
	//malo33.scale.x *= -1;
	
	
	malo35=game.add.sprite(770, 160, 'platform');
	malo35.enableBody = true;
	game.physics.arcade.enable(malo35);	
	//malo22.body.setSize(96, 35, 0, 15);
	//malo22.scale.setTo(0.5, 0.5);
	malo35.body.immovable = true;
	malo35.body.bounce.y = 0;
    malo35.body.gravity.y = 0;
	malo35.body.collideWorldBounds = true;
	/*malo35.animations.add('left',  [7,8,9,10,11], 10, true);
	malo35.animations.add('right', [2,3,4,5], 10, true);*/
	
	/*malo35=game.add.sprite(677, 242, 'platform');
	malo35.enableBody = true;	
	game.physics.arcade.enable(malo35);	
	//malo22.body.setSize(96, 35, 0, 15);
	//malo22.scale.setTo(0.5, 0.5);
	malo35.body.immovable = true;
	malo35.body.bounce.y = 0;
    malo35.body.gravity.y = 0;
	malo35.body.collideWorldBounds = true;
	malo35.animations.add('left',  [7,8,9,10,11], 10, true);
	malo35.animations.add('right', [2,3,4,5], 10, true);*/
	/*
	malo36=game.add.sprite(577, 142, 'platform');
	malo36.enableBody = true;	
	game.physics.arcade.enable(malo36);	
	//malo22.body.setSize(96, 35, 0, 15);
	//malo22.scale.setTo(0.5, 0.5);
	malo36.body.immovable = true;
	malo36.body.bounce.y = 0;
    malo36.body.gravity.y = 0;
	malo36.body.collideWorldBounds = true;
	malo36.animations.add('left',  [7,8,9,10,11], 10, true);
	malo36.animations.add('right', [2,3,4,5], 10, true);
	*/
	/*
	malo37=game.add.sprite(177, 400, 'platform');
	malo37.enableBody = true;	
	game.physics.arcade.enable(malo37);	
	//malo22.body.setSize(96, 35, 0, 15);
	//malo22.scale.setTo(0.5, 0.5);
	malo37.body.immovable = true;
	malo37.body.bounce.y = 0;
    malo37.body.gravity.y = 0;
	malo37.body.collideWorldBounds = true;
	malo37.animations.add('left',  [7,8,9,10,11], 10, true);
	malo37.animations.add('right', [2,3,4,5], 10, true);
	
	malo38=game.add.sprite(299, 200, 'platform');
	malo38.enableBody = true;	
	game.physics.arcade.enable(malo38);	
	//malo22.body.setSize(96, 35, 0, 15);
	//malo22.scale.setTo(0.5, 0.5);
	malo38.body.immovable = true;
	malo38.body.bounce.y = 0;
    malo38.body.gravity.y = 0;
	malo38.body.collideWorldBounds = true;
	malo38.animations.add('left',  [7,8,9,10,11], 10, true);
	malo38.animations.add('right', [2,3,4,5], 10, true);
	*/
	
}

function muerte(player, malo) {
    player.kill();	
	layer.destroy();
	create();
}

//bloques
function caida(player, malo) {
	malo.animations.play('left');
    
}





var content = [
    'Ugh... Ugh... \n \
	Hey tu estas queriendo entrar al castillo gato? \n \
	Debes estar loco yo estoy escondido desde que  ugh... ugh... \n \
	Nos empezaron a cazar...Ugh.. Ugh...Suerte.',
	'Aun recuerdo el dia que nos atacaron, y se llevaron a toda mi familia y amigos...',
	'Heyy!... Que estas haciendo aca?\n \
	Yo te conozco, jugabas con mis hijos, tus padres estan mas abajo, \n \
	Con suerte pude huir del gato dragon que esta abajo \n \
	Si estas pensando bajar mas vale que seas rápido...',
	'Pense que jamas veria otra rata negra\n \
	Viniste a salvarlos cierto? \n \
	Cuanto lo siento, este lugar esta infestado de gatos dragon \n \
	Sabias que los humanos tampoco la estan pasando bien?\n \
	Cada vez veo menos de ellos...',
	'Oye Chico Rata estas seguro de querer seguir adelante? \n \
	Nosotros cometimos un error \n \
	Ya no los molestes... Ugh... ',
	'Tu debes ser el ultimo que queda  \n \
	No te imaginas el daño que han echo aqui \n \
	Esto no será personal chico rata'
	
	];

var line = [];
var wordIndex = 0;
var lineIndex = 0;
var wordDelay = 120;
var lineDelay = 1019;
var siHabla=true;
	
function habla(player, bueno) {	
    if(bueno){
		bueno.animations.play('habla');				
	}
		timer = game.time.create(true);
	
	if(siHabla && bueno){
		siHabla=false;							
		nextLine();
		timer.loop(10000, function(){
			text.text="";	
			line = [];
			wordIndex = 0;
			lineIndex = 0;
			wordDelay = 120;
			lineDelay = 1019;
			
			if(bueno){
				bueno.kill();				
				
				if(menu==6){
				
					if(typeof malo34 == "undefined"){
						malo34=game.add.sprite(300, 240, 'big');	
						malo34.enableBody = true;	
						game.physics.arcade.enable(malo34);	
						malo34.body.setSize(32, 32, 0, 0);
						malo34.scale.setTo(1.5, 1.5);
						malo34.body.bounce.y = 0;
						malo34.body.gravity.y = 600;
						malo34.body.collideWorldBounds = true;		
						malo34.animations.add('left',  [3,4],6, true);
						malo34.animations.add('right', [2,1],6, true);
					}else{
						if (malo34.alive==false)
						{
							//malo34=game.add.sprite(300, 240, 'big');	
							malo34.reset(300, 240);
							malo34.enableBody = true;	
							game.physics.arcade.enable(malo34);	
							malo34.body.setSize(32, 32, 0, 0);
							malo34.scale.setTo(1.5, 1.5);
							malo34.body.bounce.y = 0;
							malo34.body.gravity.y = 600;
							malo34.body.collideWorldBounds = true;		
							malo34.animations.add('left',  [3,4],6, true);
							malo34.animations.add('right', [2,1],6, true);
						}
					}
				}
				
					
				
			}
			siHabla=true;
		}, this);
		timer.start();
	}
	
}

function nextLine() {

    if (lineIndex === 1)
    {
        //  We're finished		
        return;
		
    }
	

    //  Split the current line on spaces, so one word per array element
    line = content[menu-1].split(' ');

    //  Reset the word index to zero (the first word in the line)
    wordIndex = 0;

    //  Call the 'nextWord' function once for each word in the line (line.length)
    //game.time.events.repeat(wordDelay, line.length, nextWord, this);
	game.time.events.repeat(wordDelay, line.length, nextWord, this);
	
    //  Advance to the next line
    lineIndex++;
	if (lineIndex !== content.length)
    {
		game.time.events.add(lineDelay, nextLine, this);
	}
	
	
	
}

function nextWord() {

    // Add the next word onto the text string, followed by a space	
    text.text = text.text.concat(line[wordIndex] + " ");

    //  Advance the word index to the next word in the line
    wordIndex++;

    //  Last word?
    if (wordIndex === line.length)
    {
        //  Add a carriage return
        text.text = text.text.concat("\n");		
        //  Get the next line after the lineDelay amount of ms has elapsed        
    }

}

function render() {
    //game.debug.body(trump);
    //game.debug.bodyInfo(trump, 32, 32);
}

</script>

</body>
</html>
